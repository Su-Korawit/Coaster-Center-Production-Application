{% extends 'base.html' %}

{% block title %}‡πÄ‡∏£‡∏¥‡πà‡∏° Focus Session - Maslow{% endblock %}

{% block content %}
<div class="animate-fade-in">
    <h2 class="text-center mb-2">‚è±Ô∏è Focus Session</h2>
    <p class="text-center text-muted mb-4">‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏≥‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏µ‡πà‡∏ä‡∏≠‡∏ö</p>

    <!-- Goal Card -->
    <div class="card mb-3">
        <div class="goal-card">
            <div class="icon-wrapper">üéØ</div>
            <div class="goal-content">
                <h4 class="goal-title">{{ goal.transformed_goal|default:goal.original_goal }}</h4>
                <div class="goal-meta">
                    <span class="goal-level {{ goal.goal_level }}">{{ goal.get_goal_level_display }}</span>
                    <span>{{ goal.selected_target }} {{ goal.baseline_unit }}</span>
                </div>
            </div>
        </div>
    </div>

    <form method="post" action="{% url 'start_focus' goal.id %}">
        {% csrf_token %}

        <!-- Duration -->
        <div class="form-group">
            <label class="form-label">‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ (‡∏ô‡∏≤‡∏ó‡∏µ)</label>
            <input type="number" name="duration" class="form-control" value="{{ suggested_duration }}" min="1"
                max="120">
        </div>

        <!-- Temptation Bundle Selection -->
        <div class="form-group">
            <label class="form-label">üéß ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å</label>

            {% if bundles %}
            <div style="display: flex; flex-direction: column; gap: 8px;">
                <label class="level-option" style="cursor: pointer;">
                    <input type="radio" name="bundle_id" value="" checked style="display: none;">
                    <div class="icon" style="background: var(--bg-secondary);">üö´</div>
                    <div class="info">
                        <div class="title">‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ Temptation Bundler</div>
                        <small class="text-muted">‡πÇ‡∏ü‡∏Å‡∏±‡∏™‡πÅ‡∏ö‡∏ö‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤</small>
                    </div>
                </label>

                {% for bundle in bundles %}
                <label class="level-option" style="cursor: pointer;">
                    <input type="radio" name="bundle_id" value="{{ bundle.id }}" style="display: none;">
                    <div class="icon" style="background: rgba(139, 92, 246, 0.2);">{{ bundle.icon }}</div>
                    <div class="info">
                        <div class="title">{{ bundle.activity_name }}</div>
                        <small class="text-muted">{{ bundle.get_activity_type_display }}</small>
                    </div>
                </label>
                {% endfor %}
            </div>
            {% else %}
            <div class="card">
                <p class="text-muted text-center">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</p>
                <a href="{% url 'add_temptation' %}" class="btn btn-secondary btn-block">
                    ‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏µ‡πà‡∏ä‡∏≠‡∏ö
                </a>
            </div>
            {% endif %}
        </div>

        <button type="submit" class="btn btn-primary btn-block btn-lg mt-4">
            ‚ñ∂Ô∏è ‡πÄ‡∏£‡∏¥‡πà‡∏° Focus Session
        </button>
    </form>

    <div class="text-center mt-3">
        <a href="{% url 'home' %}" class="text-muted">‚Üê ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</a>
    </div>
</div>

<script>
    // Highlight selected option
    document.querySelectorAll('.level-option').forEach(option => {
        option.addEventListener('click', () => {
            document.querySelectorAll('.level-option').forEach(o => o.classList.remove('selected'));
            option.classList.add('selected');
        });
    });
</script>
{% endblock %}